<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>éµã®è¦‹ãŸç›®ã‚·ã‚¹ãƒ†ãƒ </title>
  <style>
    body {
      font-family: sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 0;
    }
    .header-container {
      position: relative;
      text-align: center;
      padding-top: 1rem;
    }
    .header-gif {
      max-width: 640px;
      width: 100%;
      height: auto;
      object-fit: contain;
      display: block;
      margin: 0 auto;
    }
    .reload-button {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #333;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .reload-button:hover {
      background: #555;
    }
    .music-controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 0.8rem;
      margin: 1rem auto;
      padding: 0 1rem;
    }
    .music-controls button {
      flex: 1 1 120px;
      background: #607d8b;
      color: white;
      border: none;
      padding: 0.7rem 1rem;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
    }
    .music-controls button:hover {
      background: #78909c;
    }
    .container {
      max-width: 600px;
      width: 90%;
      margin: auto;
      background: white;
      padding: 2rem 1.5rem;
      border-radius: 10px;
      margin-top: 1rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2 {
      font-size: 1.2rem;
      margin-bottom: 1rem;
    }
    select, input, textarea, button {
      width: 100%;
      padding: 0.8rem;
      font-size: 1rem;
      margin-bottom: 1rem;
      border-radius: 5px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    textarea { resize: vertical; }
    button {
      background: #4CAF50;
      color: white;
      border: none;
    }
    button:hover {
      opacity: 0.9;
    }
    .danger {
      background: #e53935;
    }
    .info {
      background: #039be5;
    }
    p {
      background: #eef;
      padding: 1rem;
      border-left: 5px solid #88c;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <div class="header-container">
    <img id="headerGif" class="header-gif" src="" alt="ãƒ˜ãƒƒãƒ€ãƒ¼GIF" />
    <button class="reload-button" onclick="reloadGif()">ğŸ”„ GIFå¤‰æ›´</button>
  </div>

  <div class="music-controls">
    <button id="toggleMusic" onclick="toggleMusic()">â–¶ï¸ éŸ³æ¥½å†ç”Ÿ</button>
  </div>
  <audio id="bgm" src="utsu_8bit.mp3" loop></audio>

  <div class="container">
    <h2>ğŸ”‘ éµã‚’æ¤œç´¢ãƒ»é¸ã‚“ã§è¦‹ãŸç›®ã‚’è¡¨ç¤º</h2>
    <input type="text" id="searchInput" placeholder="éµã®åå‰ã‚’æ¤œç´¢â€¦" oninput="refreshSelect()" />
    <select id="keySelect" onchange="updateDescription()">
      <option value="">-- éµã‚’é¸ã‚“ã§ãã ã•ã„ --</option>
    </select>
    <p id="description">ã“ã“ã«éµã®è¦‹ãŸç›®ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
    <button class="info" onclick="loadEdit()">âœï¸ ç·¨é›†</button>
    <button class="danger" onclick="deleteKey()">ğŸ—‘ï¸ å‰Šé™¤</button>

    <hr>
    <h2>ğŸ“ éµã®è¿½åŠ ãƒ»ç·¨é›†</h2>
    <input type="text" id="newKeyName" placeholder="éµã®åå‰ï¼ˆä¾‹ï¼šé’ã„éµï¼‰" />
    <textarea id="newKeyDesc" placeholder="è¦‹ãŸç›®ã®èª¬æ˜ã‚’å…¥åŠ›"></textarea>
    <button onclick="saveKey()">ğŸ’¾ ä¿å­˜</button>

    <h2>ğŸ“¤ éµãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨å¾©å…ƒ</h2>
    <button onclick="exportKeys()">â¬‡ï¸ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆä¿å­˜ï¼‰</button>
    <input type="file" id="importFile" accept="application/json" onchange="importKeys(event)" />
  </div>

  <script>
    const gifList = ["gif1.gif", "gif2.gif", "gif3.gif"];
    function reloadGif() {
      const newGif = gifList[Math.floor(Math.random() * gifList.length)];
      document.getElementById("headerGif").src = newGif + "?t=" + new Date().getTime();
    }
    reloadGif();

    const selectEl = document.getElementById("keySelect");
    const descEl = document.getElementById("description");
    const searchEl = document.getElementById("searchInput");
    let keys = JSON.parse(localStorage.getItem("keys")) || {
  "ãƒã‚¹ã‚¿ãƒ¼ã‚­ãƒ¼": "å®‡å®™é£›è¡Œå£«
æµã—ã®ä¸‹",
  "è–¬å±€": "ã§ã‹ã„åŠå††ã«éµã„ã£ã±ã„
è¨ºå¯Ÿåˆ¸ç™ºè¡Œæ©Ÿã®ä¸‹ã®é‡˜ã«ã‹ã‘ã‚‹",
  "è¨ªå•çœ‹è­·": "ã§ã‹ã„ãƒ©ãƒŸãƒãƒ¼ãƒˆã®èª¬æ˜æ–‡
æµã—ã®ä¸‹",
  "é¢¨é™¤å®¤è‡ªå‹•ãƒ‰ã‚¢ã‚¹ã‚¤ãƒƒãƒBOX": "é’",
  "å›å¾©æœŸãƒªãƒãƒ“ãƒª": "éª¨",
  "æ•´å½¢å¤–ç§‘": "ç·‘ã€Œæ•´ã‚µã‚¦ãƒŠã€",
  "è¨ªå•çœ‹è­·ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒšãƒ³ã‚®ãƒ³": "ãƒ”ãƒ³ã‚¯",
  "çœ¼ç§‘": "çœ¼ç§‘ã‚ªãƒ¬ãƒ³ã‚¸
çœ¼ç§‘(ãƒ–ãƒ­ãƒƒã‚¯å—ä»˜)ç·‘
éµ2æœ¬",
  "çœ‹è­·éƒ¨é•·å®¤": "ç·‘",
  "ICU": "ãƒ–ãƒ«ãƒ¼ã‚°ãƒ¬ãƒ¼",
  "ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼å®¤": "é’",
  "çš®è†šç§‘": "é»„è‰²",
  "è€³é¼»ç§‘": "èµ¤
éµ3æœ¬",
  "å†…è¦–é¡å®¤": "èµ¤",
  "å¥åº·ç®¡ç†ç§‘": "ãƒ”ãƒ³ã‚¯
éµ3æœ¬(1æœ¬å¤‰ãªå½¢)",
  "ç”¨å…·å€‰åº«": "æ°´è‰²",
  "å‡¦ç½®å®¤": "æ°´è‰²ã€ç·‘æ–‡å­—",
  "éš”é›¢å®¤": "é»„è‰²",
  "å¤–ç§‘": "èµ¤",
  "ç·å‹™èª²": "ã§ã‹ç·‘
ã€ŒèŠ±ã¨æ£®ã®æ±äº¬ç—…é™¢ç·å‹™èª²ã€",
  "çœ‹è­·å©¦(å®¿ç›´3)": "é»„è‰²",
  "1éšå¤–éšæ®µ(å—äº¬éŒ )": "é’",
  "é§’è¾¼": "é»„è‰²
TOYOTA",
  "ç‹å­": "ç·‘
TOYOTA",
  "å†…ç§‘": "ãã‚‹ãã‚‹
ãƒˆãƒ­ãƒ”ã‚«ãƒ«ã‚«ãƒ©ãƒ¼
ã‚­ãƒ¼ãƒãƒ³ãƒ‰",
  "å›å¾©æœŸãƒªãƒãƒ“ãƒªã€€ãƒªãƒç§‘": "éª¨",
  "åŒ»äº‹ä¿‚": "èµ¤
ã‚¦ãƒŠã‚®ã‚¤ãƒŒ",
  "ã‚ªãƒšå®¤ã€€æ‰‹è¡“ãƒ»æ¸›æå®¤": "é»„è‰²",
  "åŒ»äº‹ä¿‚ã€€äº‹å‹™å®¤": "èµ¤
ã‚¦ãƒŠã‚®ã‚¤ãƒŒ",
  "åœ°ä¸‹1éšã€€é£Ÿå ‚æ¨ªäº‹å‹™å®¤": "ã‚·ãƒ«ãƒãƒ¼å—äº¬éŒ 
æ°´è‰²ã‚¿ã‚°"
};

    function normalize(text) {
      return text
        .toLowerCase()
        .replace(/\s/g, '')
        .replace(/[ï¼¡-ï¼ºï½-ï½šï¼-ï¼™]/g, s => String.fromCharCode(s.charCodeAt(0) - 0xFEE0))
        .replace(/[\u30a1-\u30f6]/g, s => {
          const kanaMap = {
            'ã‚¡': 'ã‚', 'ã‚£': 'ã„', 'ã‚¥': 'ã†', 'ã‚§': 'ãˆ', 'ã‚©': 'ãŠ',
            'ã‚¬': 'ã‹', 'ã‚®': 'ã', 'ã‚°': 'ã', 'ã‚²': 'ã‘', 'ã‚´': 'ã“',
            'ã‚µ': 'ã•', 'ã‚·': 'ã—', 'ã‚¹': 'ã™', 'ã‚»': 'ã›', 'ã‚½': 'ã',
            'ã‚¿': 'ãŸ', 'ãƒ': 'ã¡', 'ãƒ„': 'ã¤', 'ãƒ†': 'ã¦', 'ãƒˆ': 'ã¨',
            'ãƒŠ': 'ãª', 'ãƒ‹': 'ã«', 'ãƒŒ': 'ã¬', 'ãƒ': 'ã­', 'ãƒ': 'ã®',
            'ãƒ': 'ã¯', 'ãƒ’': 'ã²', 'ãƒ•': 'ãµ', 'ãƒ˜': 'ã¸', 'ãƒ›': 'ã»',
            'ãƒ': 'ã¾', 'ãƒŸ': 'ã¿', 'ãƒ ': 'ã‚€', 'ãƒ¡': 'ã‚', 'ãƒ¢': 'ã‚‚',
            'ãƒ¤': 'ã‚„', 'ãƒ¦': 'ã‚†', 'ãƒ¨': 'ã‚ˆ',
            'ãƒ©': 'ã‚‰', 'ãƒª': 'ã‚Š', 'ãƒ«': 'ã‚‹', 'ãƒ¬': 'ã‚Œ', 'ãƒ­': 'ã‚',
            'ãƒ¯': 'ã‚', 'ãƒ²': 'ã‚’', 'ãƒ³': 'ã‚“',
            'ãƒ¼': '', 'ãƒƒ': '', 'ãƒ£': 'ã‚„', 'ãƒ¥': 'ã‚†', 'ãƒ§': 'ã‚ˆ'
          };
          return kanaMap[s] || s;
        });
    }

    function refreshSelect() {
      const filter = normalize(searchEl.value);
      selectEl.innerHTML = '<option value="">-- éµã‚’é¸ã‚“ã§ãã ã•ã„ --</option>';
      Object.keys(keys)
        .sort((a, b) => normalize(a).localeCompare(normalize(b), 'ja'))
        .filter(name => normalize(name).includes(filter))
        .forEach(name => {
          const option = document.createElement("option");
          option.value = name;
          option.textContent = name;
          selectEl.appendChild(option);
        });
    }

    function updateDescription() {
      const key = selectEl.value;
      descEl.textContent = key && keys[key] ? keys[key] : "ã“ã“ã«éµã®è¦‹ãŸç›®ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚";
    }

    function saveKey() {
      const name = document.getElementById("newKeyName").value.trim();
      const desc = document.getElementById("newKeyDesc").value.trim();
      if (!name || !desc) {
        alert("åå‰ã¨èª¬æ˜ã®ä¸¡æ–¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
        return;
      }
      keys[name] = desc;
      localStorage.setItem("keys", JSON.stringify(keys));
      refreshSelect();
      alert("ä¿å­˜ã—ã¾ã—ãŸï¼");
      clearInput();
    }

    function deleteKey() {
      const selected = selectEl.value;
      if (!selected || !keys[selected]) {
        alert("å‰Šé™¤ã™ã‚‹éµã‚’é¸ã‚“ã§ãã ã•ã„ã€‚");
        return;
      }
      if (!confirm(`ã€Œ${selected}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) return;
      delete keys[selected];
      localStorage.setItem("keys", JSON.stringify(keys));
      refreshSelect();
      updateDescription();
      alert("å‰Šé™¤ã—ã¾ã—ãŸã€‚");
    }

    function loadEdit() {
      const selected = selectEl.value;
      if (!selected || !keys[selected]) {
        alert("ç·¨é›†ã™ã‚‹éµã‚’é¸ã‚“ã§ãã ã•ã„ã€‚");
        return;
      }
      document.getElementById("newKeyName").value = selected;
      document.getElementById("newKeyDesc").value = keys[selected];
    }

    function clearInput() {
      document.getElementById("newKeyName").value = "";
      document.getElementById("newKeyDesc").value = "";
    }

    function exportKeys() {
      const blob = new Blob([JSON.stringify(keys, null, 2)], { type: "application/json" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "keys_backup.json";
      link.click();
    }

    function importKeys(event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const imported = JSON.parse(e.target.result);
          if (typeof imported !== 'object') throw new Error();
          keys = imported;
          localStorage.setItem("keys", JSON.stringify(keys));
          refreshSelect();
          alert("ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Œäº†ã—ã¾ã—ãŸï¼");
        } catch {
          alert("ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¤±æ•—ï¼šæ­£ã—ã„JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚");
        }
      };
      reader.readAsText(file);
    }

    function toggleMusic() {
      const audio = document.getElementById("bgm");
      const button = document.getElementById("toggleMusic");
      if (audio.paused) {
        audio.play();
        button.textContent = "â¹ éŸ³æ¥½åœæ­¢";
      } else {
        audio.pause();
        button.textContent = "â–¶ï¸ éŸ³æ¥½å†ç”Ÿ";
      }
    }

    refreshSelect();
  </script>
</body>
</html>
