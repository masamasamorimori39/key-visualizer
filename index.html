<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>éµã®è¦‹ãŸç›®ã‚·ã‚¹ãƒ†ãƒ </title>
  <style>
    body {
      font-family: sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 0;
    }
    .header-container {
      position: relative;
      text-align: center;
      padding-top: 1rem;
    }
    .header-gif {
      max-width: 640px;
      width: 100%;
      height: auto;
      object-fit: contain;
      display: block;
      margin: 0 auto;
    }
    .reload-button {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #333;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .reload-button:hover {
      background: #555;
    }
    .music-controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 0.8rem;
      margin: 1rem auto;
      padding: 0 1rem;
    }
    .music-controls button {
      flex: 1 1 120px;
      background: #607d8b;
      color: white;
      border: none;
      padding: 0.7rem 1rem;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
    }
    .music-controls button:hover {
      background: #78909c;
    }
    .container {
      max-width: 600px;
      width: 90%;
      margin: auto;
      background: white;
      padding: 2rem 1.5rem;
      border-radius: 10px;
      margin-top: 1rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2 {
      font-size: 1.2rem;
      margin-bottom: 1rem;
    }
    select, input, textarea, button {
      width: 100%;
      padding: 0.8rem;
      font-size: 1rem;
      margin-bottom: 1rem;
      border-radius: 5px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    textarea { resize: vertical; }
    button {
      background: #4CAF50;
      color: white;
      border: none;
    }
    button:hover {
      opacity: 0.9;
    }
    .danger {
      background: #e53935;
    }
    .info {
      background: #039be5;
    }
    p {
      background: #eef;
      padding: 1rem;
      border-left: 5px solid #88c;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <div class="header-container">
    <img id="headerGif" class="header-gif" src="" alt="ãƒ˜ãƒƒãƒ€ãƒ¼GIF" />
    <button class="reload-button" onclick="reloadGif()">ğŸ”„ GIFå¤‰æ›´</button>
  </div>

  <div class="music-controls">
    <button onclick="document.getElementById('bgm').play()">â–¶ï¸ éŸ³æ¥½å†ç”Ÿ</button>
    <button onclick="document.getElementById('bgm').pause()">â¹ éŸ³æ¥½åœæ­¢</button>
  </div>
  <audio id="bgm" src="utsu_8bit.mp3" loop></audio>

  <div class="container">
    <h2>ğŸ”‘ éµã‚’æ¤œç´¢ãƒ»é¸ã‚“ã§è¦‹ãŸç›®ã‚’è¡¨ç¤º</h2>
    <input type="text" id="searchInput" placeholder="éµã®åå‰ã‚’æ¤œç´¢â€¦" oninput="refreshSelect()" />
    <select id="keySelect" onchange="updateDescription()">
      <option value="">-- éµã‚’é¸ã‚“ã§ãã ã•ã„ --</option>
    </select>
    <p id="description">ã“ã“ã«éµã®è¦‹ãŸç›®ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
    <button class="info" onclick="loadEdit()">âœï¸ ç·¨é›†</button>
    <button class="danger" onclick="deleteKey()">ğŸ—‘ï¸ å‰Šé™¤</button>

    <hr>
    <h2>ğŸ“ éµã®è¿½åŠ ãƒ»ç·¨é›†</h2>
    <input type="text" id="newKeyName" placeholder="éµã®åå‰ï¼ˆä¾‹ï¼šé’ã„éµï¼‰" />
    <textarea id="newKeyDesc" placeholder="è¦‹ãŸç›®ã®èª¬æ˜ã‚’å…¥åŠ›"></textarea>
    <button onclick="saveKey()">ğŸ’¾ ä¿å­˜</button>
  </div>

  <script>
    const gifList = [
      "ãƒã‚­ã‚·ãƒãƒ ã‚¶ãƒ›ãƒ«ãƒ¢ãƒ³.gif",
      "ãƒã‚­ã‚·ãƒãƒ ã‚¶ãƒ›ãƒ«ãƒ¢ãƒ³-2.gif",
      "ãƒã‚­ã‚·ãƒãƒ ã‚¶ãƒ›ãƒ«ãƒ¢ãƒ³-3.gif"
    ];
    function reloadGif() {
      const newGif = gifList[Math.floor(Math.random() * gifList.length)];
      document.getElementById("headerGif").src = newGif + "?t=" + new Date().getTime();
    }
    reloadGif();

    const selectEl = document.getElementById("keySelect");
    const descEl = document.getElementById("description");
    const searchEl = document.getElementById("searchInput");
    let keys = JSON.parse(localStorage.getItem("keys")) || {};

    function refreshSelect() {
      const filter = searchEl.value.trim().toLowerCase();
      selectEl.innerHTML = '<option value="">-- éµã‚’é¸ã‚“ã§ãã ã•ã„ --</option>';
      Object.keys(keys)
        .filter(name => name.toLowerCase().includes(filter))
        .forEach(name => {
          const option = document.createElement("option");
          option.value = name;
          option.textContent = name;
          selectEl.appendChild(option);
        });
    }

    function updateDescription() {
      const key = selectEl.value;
      descEl.textContent = key && keys[key] ? keys[key] : "ã“ã“ã«éµã®è¦‹ãŸç›®ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚";
    }

    function saveKey() {
      const name = document.getElementById("newKeyName").value.trim();
      const desc = document.getElementById("newKeyDesc").value.trim();
      if (!name || !desc) {
        alert("åå‰ã¨èª¬æ˜ã®ä¸¡æ–¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
        return;
      }
      keys[name] = desc;
      localStorage.setItem("keys", JSON.stringify(keys));
      refreshSelect();
      alert("ä¿å­˜ã—ã¾ã—ãŸï¼");
      clearInput();
    }

    function deleteKey() {
      const selected = selectEl.value;
      if (!selected || !keys[selected]) {
        alert("å‰Šé™¤ã™ã‚‹éµã‚’é¸ã‚“ã§ãã ã•ã„ã€‚");
        return;
      }
      if (!confirm(`ã€Œ${selected}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) return;
      delete keys[selected];
      localStorage.setItem("keys", JSON.stringify(keys));
      refreshSelect();
      updateDescription();
      alert("å‰Šé™¤ã—ã¾ã—ãŸã€‚");
    }

    function loadEdit() {
      const selected = selectEl.value;
      if (!selected || !keys[selected]) {
        alert("ç·¨é›†ã™ã‚‹éµã‚’é¸ã‚“ã§ãã ã•ã„ã€‚");
        return;
      }
      document.getElementById("newKeyName").value = selected;
      document.getElementById("newKeyDesc").value = keys[selected];
    }

    function clearInput() {
      document.getElementById("newKeyName").value = "";
      document.getElementById("newKeyDesc").value = "";
    }

    refreshSelect();
  </script>
</body>
</html>
